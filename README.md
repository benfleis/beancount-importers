Started here:

https://gist.github.com/mterwill/7fdcc573dc1aa158648aacd4e33786e8

Then hacked a bit.
